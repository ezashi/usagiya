<!DOCTYPE html>
<html lang="ja">

<head>
    <title><%= content_for?(:title) ? yield(:title) : "御菓子処うさぎや" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>

    <!-- React Quill CSS -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

    <!-- React Datepicker CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/react-datepicker@4.21.0/dist/react-datepicker.min.css">

    <!-- React Big Calendar CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/react-big-calendar@1.8.5/lib/css/react-big-calendar.css">

    <!-- Trix Editor CSS (Action Text用) -->
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/trix@2.0.0/dist/trix.css">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            background-color: #ffffff !important;
            min-height: 100vh;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', Arial, sans-serif;
            overflow-x: hidden;
            background-color: #ffffff !important;
            min-height: 100vh;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Turbo読み込み中も背景を白に保つ */
        body.turbo-loading,
        body[data-turbo-preview],
        html.turbo-progress-bar {
            background-color: #ffffff !important;
        }

        /* すべてのメインコンテナも白背景 */
        #home-root,
        #featured-products-root,
        #seasonal-products-root,
        main,
        .container {
            background-color: #ffffff !important;
        }

        img {
            background-color: transparent;
        }

        [id$="-root"] {
            background-color: #ffffff !important;
            min-height: 100vh;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            z-index: -1;
        }
    </style>

    <%= yield :page_styles %>

    <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module" %>

    <script>
        document.addEventListener('turbo:before-cache', function() {
            document.documentElement.style.backgroundColor = '#ffffff';
            document.body.style.backgroundColor = '#ffffff';
        });

        document.addEventListener('turbo:before-render', function() {
            document.documentElement.style.backgroundColor = '#ffffff';
            document.body.style.backgroundColor = '#ffffff';
        });
    </script>
</head>

<body style="background-color: #ffffff !important;">
    <!-- 共通ヘッダー（管理画面以外） -->
    <% unless controller_path.start_with?('admin') %>
    <%= render 'shared/header' %>
    <% end %>

    <%= yield %>
    <%= yield :page_scripts %>
</body>

</html>